Identifying samples in an evolutionary context is a fundamental step in the study of microbiome, and more broadly, biodiversity. Extending a reference phylogeny by placing new query sequences onto it has been increasingly used for sample identification and other applications. Existing phylogenetic placement methods have assumed that the query sequence is homologous to the data used to infer the reference phylogeny. Thus, they are designed to place data from a single gene onto a gene tree (e.g., they can place 16S sequences onto a 16S gene tree). While this assumption is reasonable, ultimately, sample identification is a question of identifying the species not individual genes. The placement of single gene data on a gene tree is therefore used as a proxy for a more ambitious goal: extending a species tree given sequence data from one or more gene. This goal poses difficult algorithmic questions. Nevertheless, a sufficiently accurate solution would not only improve sample identification using marker genes, it would also help achieving the long-standing goal of combining 16S and metagenomic data. We approach this problem using deep neural networks (DNN) and introduce a method called DEPP. Given a reference species tree and sequence data from one (or a handful of) genes, DEPP learns how to extend the species tree to include new species. DEPP does not rely on pre-specified models of sequence evolution or gene tree discordance; instead, it uses highly parameterized DNNs to learn both aspects from the data. We test DEPP both in simulations and on real microbial data and show high accuracy.
